from https://github.com/flostyen/windows-persistence
